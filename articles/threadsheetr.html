<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="threadsheetr">
<title>Weaving Tabular Datasets using ThreadsheetR • threadsheetr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Weaving Tabular Datasets using ThreadsheetR">
<meta property="og:description" content="threadsheetr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">threadsheetr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/threadsheetr.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jpowerj/threadsheetr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Weaving Tabular Datasets using ThreadsheetR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jpowerj/threadsheetr/blob/HEAD/vignettes/threadsheetr.Rmd" class="external-link"><code>vignettes/threadsheetr.Rmd</code></a></small>
      <div class="d-none name"><code>threadsheetr.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jpowerj/threadsheetr" class="external-link">threadsheetr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="the-problem">The Problem<a class="anchor" aria-label="anchor" href="#the-problem"></a>
</h2>
<p>While working on my PhD dissertation (a chapter on Cold War diplomacy
that didn’t make it into the final version…) I found myself trying to
juggle hundreds of different datasets, which I had OCRed into
<code>.csv</code> format, from sources like the US State Department,
CIA, and official Soviet statistical publications. Each source used
different conventions (e.g., names for countries or regions) and
structures (e.g., some with countries on the <span class="math inline">\(x\)</span>-axis and years on the <span class="math inline">\(y\)</span>-axis, others with just three columns:
country, year, value). So, even to get to the stage of being able to
impute missing datapoints, I had to find some way to align these
different formats. That’s task 1 that <code>threadsheetr</code>
automates for us.</p>
<p>Then, a second problem arose: at first, when I only had (say) two
differing estimates for a given country-year pair, I could get away with
just creating a new “master dataset” whose cells represented
manually-computed averages between the two estimates. As the project
progressed, however, I realized this was way above my pay grade: I’d
have 4, 5, sometimes 6 or more estimates for a given quantity, and if I
decided to remove one, or downweight one of the sources as less
trustworthy, or use the median instead of the mean… Every cell in the
master dataset had to be re-calculated. This is when I realized I needed
a way to automate this task, and <code>threadsheetr</code> was born.</p>
<p>In summary, the two main problems that <code>threadsheetr</code> sets
out to solve are:</p>
<ol style="list-style-type: decimal">
<li>Datasets in a range of non-standard formats—wide, long, multiple
headers, etc.: <code>threadsheetr</code> parses them so that different
datapoints from different input files can be compared, aggregated,
imputed, etc.</li>
<li>Datasets with disagree on the same underlying value: Given an
aggregation function and a set of “trust scores”,
<code>threadsheetr</code> automates the process of combining individual
estimates into a single “master dataset” containing the trust-weighted
average of these individual estimates.</li>
<li>Datasets with missing data: While other R packages like
<code>mice</code> provide sophisticated data imputation algorithms which
should be used for more intensive data-concordance tasks,
<code>threadsheetr</code> contains implementations of some simple data
imputation algorithms to allow the generation of “ballpark” estimates of
these missing values (as part of a larger grid of aggregated estimate
values)</li>
</ol>
<p>In addition, <code>threadsheetr</code> interfaces with both GitHub
and Google Sheets to produce interactive color-coded master data grids,
allowing you to visualize the current state of your data
aggregation/imputation: Green cells, for example, represent values for
which all sources are in agreement, while yellow cells represent those
with conflicting values. Crucially, hovering your mouse over these
columns brings up a popover box containing a description of how the
estimate was arrived at: by hovering over these yellow cells, for
example, you can see a listing of each source file used, their
respective trust weights and estimates of the cell’s value.</p>
</div>
<div class="section level2">
<h2 id="step-1-parsing-raw-data-files">Step 1: Parsing Raw Data Files<a class="anchor" aria-label="anchor" href="#step-1-parsing-raw-data-files"></a>
</h2>
</div>
<div class="section level2">
<h2 id="step-2-combining-parsed-files">Step 2: Combining Parsed Files<a class="anchor" aria-label="anchor" href="#step-2-combining-parsed-files"></a>
</h2>
</div>
<div class="section level2">
<h2 id="step-3-aggregating-individual-estimates-into-master-grid">Step 3: Aggregating Individual Estimates into Master Grid<a class="anchor" aria-label="anchor" href="#step-3-aggregating-individual-estimates-into-master-grid"></a>
</h2>
</div>
<div class="section level2">
<h2 id="step-4-viewing-summary-statistics">Step 4: Viewing Summary Statistics<a class="anchor" aria-label="anchor" href="#step-4-viewing-summary-statistics"></a>
</h2>
</div>
<div class="section level2">
<h2 id="step-5-pushing-to-github-and-generating-color-coded-google-sheets">Step 5: Pushing to GitHub and Generating Color-Coded Google
Sheets<a class="anchor" aria-label="anchor" href="#step-5-pushing-to-github-and-generating-color-coded-google-sheets"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jeff Jacobs.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
